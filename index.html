<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BFHL API Tester</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Inter', sans-serif; }
  pre { white-space: pre-wrap; word-wrap: break-word; }
</style>
</head>
<body class="bg-gray-100 text-gray-800">

<div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
  <header class="text-center mb-8">
    <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">API Interaction Panel</h1>
    <p class="text-gray-600 mt-2">Enter your data array to test the `/bfhl` endpoint.</p>
  </header>

  <main class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
    <div class="mb-6">
      <label for="dataInput" class="block text-lg font-semibold mb-2 text-gray-700">Input Array</label>
      <p class="text-sm text-gray-500 mb-3">Enter values separated by commas (e.g., a,1,334,4,R,$).</p>
      <input type="text" id="dataInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow" placeholder="e.g., 2,a,y,4,&,-,*,5,92,b">
    </div>

    <div class="text-center">
      <button id="submitBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105">Process Array</button>
    </div>

    <div id="loading" class="hidden text-center my-4">
      <svg class="animate-spin h-8 w-8 text-blue-600 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <p class="mt-2 text-gray-600">Processing...</p>
    </div>

    <div id="errorBox" class="hidden mt-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
      <p class="font-bold">Error!</p>
      <p id="errorMessage"></p>
    </div>

    <div id="results" class="hidden mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="bg-gray-50 p-4 rounded-lg border">
        <h3 class="text-xl font-semibold mb-3 text-gray-800">Request Payload (Output)</h3>
        <pre id="request-output" class="bg-gray-200 text-gray-800 p-3 rounded-md text-sm"></pre>
      </div>

      <div class="bg-gray-50 p-4 rounded-lg border">
        <h3 class="text-xl font-semibold mb-3 text-gray-800">API Response (Output)</h3>
        <pre id="response-output" class="bg-gray-200 text-gray-800 p-3 rounded-md text-sm"></pre>
      </div>
    </div>
  </main>
</div>

<script>
const dataInput = document.getElementById('dataInput');
const submitBtn = document.getElementById('submitBtn');
const resultsDiv = document.getElementById('results');
const requestOutput = document.getElementById('request-output');
const responseOutput = document.getElementById('response-output');
const loadingSpinner = document.getElementById('loading');
const errorBox = document.getElementById('errorBox');
const errorMessage = document.getElementById('errorMessage');
const API_URL = "http://localhost:3000/bfhl";

submitBtn.addEventListener('click', async () => {
    const rawInput = dataInput.value;
    if (!rawInput.trim()) {
        alert('Please enter some data.');
        return;
    }

    const inputArray = rawInput.split(',').map(item => item.trim());
    const requestPayload = { data: inputArray };

    requestOutput.textContent = JSON.stringify(requestPayload, null, 2);
    responseOutput.textContent = '';
    resultsDiv.classList.remove('hidden');
    errorBox.classList.add('hidden');
    loadingSpinner.classList.remove('hidden');

    try {
        const response = await fetch(API_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(requestPayload)
        });

        const responseData = await response.json();

        if (!response.ok) {
            throw new Error(responseData.error || `HTTP error! Status: ${response.status}`);
        }

        responseOutput.textContent = JSON.stringify(responseData, null, 2);

    } catch (error) {
        errorMessage.textContent = `Failed to fetch API. Details: ${error.message}`;
        errorBox.classList.remove('hidden');
        resultsDiv.classList.add('hidden');
    } finally {
        loadingSpinner.classList.add('hidden');
    }
});
</script>

</body>
</html>
